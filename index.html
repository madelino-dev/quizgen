<!DOCTYPE html>
<html>
<head>
    <title>Investment Quiz</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/babel-standalone@6.26.0/babel.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const getRandomMultiplier = () => Math.floor(Math.random() * 5) + 1;
        const formatMoney = (amount) => `$${amount.toLocaleString()}`;
        const shuffleArray = (array) => {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        };

        const Quiz = () => {
            const [multiplier, setMultiplier] = React.useState(getRandomMultiplier());
            const [selectedAnswers, setSelectedAnswers] = React.useState({});

            const handleOptionSelect = (questionIndex, optionIndex) => {
                setSelectedAnswers(prev => ({
                    ...prev,
                    [questionIndex]: optionIndex
                }));
            };

            const allQuestions  = [
                {
                    question: `You have a firm that starts out with ${formatMoney(65000 * multiplier)} in cash. You have three investment opportunities. The discount rate is 18%. Which investments, if any, do you undertake? Choose all that apply.`,
                    alternatives: shuffleArray([
                        `Invest ${formatMoney(40000 * multiplier)} today for a payoff of ${formatMoney(49000 * multiplier)} next year`,
                        `Invest ${formatMoney(23000 * multiplier)} today for a payoff of ${formatMoney(30000 * multiplier)} in two years`,
                        `Invest ${formatMoney(12000 * multiplier)} today for a payoff of ${formatMoney(2000 * multiplier)} every year, forever.`
                    ])
                },
                {
                    question: `ABC Software is considering starting a new division making phone apps. It forecasts that the free cash flows for this division in 5 years will be ${formatMoney(215000 * multiplier)}. What is the terminal value as of year 5 for the division with a 3% perpetual growth rate and a 12% discount rate?`,
                    textInput: true
                },
                {
                    question: "Errors in the discount rate can be problematic because: (Choose all that apply.)",
                    alternatives: shuffleArray([
                        "This can lead to mistaken investment decisions.",
                        "This can lead to erroneous decisions to repurchase shares.",
                        "This produces higher measured firm beta.",
                        "This can lead to mistaken calculations of EBIT."
                    ])
                },
                {
                    question: "A typical way of obtaining the risk-free rate is by using the:",
                    alternatives: shuffleArray([
                        "1-year risk-free government bond rate",
                        "10-year risk-free government bond rate",
                        "Difference between the average market return and the return on government bonds",
                        "Correlation between a firm's returns and the market returns."
                    ])
                },
                {
                    question: "A typical way of obtaining a firm's beta is by using the:",
                    alternatives: shuffleArray([
                        "1-year risk-free government bond rate",
                        "10-year risk-free government bond rate",
                        "Difference between the average market return and the return on government bonds",
                        "Correlation between a firm's returns and the market returns."
                    ])
                },
                {
                    question: "It is common to use comparable firms' information as inputs for: (Choose all that apply.)",
                    alternatives: shuffleArray([
                        "A firm's capital structure.",
                        "The unlevered cost of equity.",
                        "A firm's tax rate.",
                        "The risk-free rate."
                    ])
                },
                {
                    question: "What advice would you give to someone who was just starting to use modern valuation tools? Choose all that apply.",
                    alternatives: shuffleArray([
                        "The terminal value (and our assumptions about long-term growth rate) can have a very large impact on your calculation of the value of a firm.",
                        "Ultimately, the value of a firm is negotiated between multiple parties, and discounted cash flows are only a tool that informs the negotiation.",
                        "We need to take into account the possibility that the risk-free rate and the market risk premium change over time by using a higher beta in the discount rate.",
                        "It is important to perform sensitivity analysis around the most critical assumptions of a model.",
                        "Using multiples to value a large, well-established, firm is usually a better method than discounted cash flows."
                    ])
                },
                {
                      question: `Estimate the asset beta for XYZ, given comparable firms have a beta of ${[1.1, 1.2, 1.3, 0.9, 0.8][multiplier-1]} and a 20% market leverage (D/V). Assume the beta of debt is 0. Show your work.`,
                      textInput: true
                    },
                    {
                      question: `Estimate XYZ's cost of equity if the risk-free rate is 4%, market risk premium is 5%, and market leverage is 40% (D/V). Show your work.`,
                      textInput: true
                    },
                    {
                      question: `Estimate XYZ's weighted average cost of capital (WACC) if its cost of debt is ${[6, 6.5, 7, 5.5, 5][multiplier-1]}% and the tax rate is 40%. Show your work.`,
                      textInput: true
                    },
                    {
                      question: "Please enter your name:",
                      textInput: true
                    }

            ];
           
            const blockA = allQuestions.slice(0, 2);  // First two questions
            const blockB = allQuestions.slice(2, 5);  // Questions 3-5
            const blockC = allQuestions.slice(5, 7);  // Questions 6-7
            const blockD = allQuestions.slice(7, 10);     // Last three questions
            const blockE = allQuestions.slice(10);     // Name

            const middleBlocks = shuffleArray([blockA, blockB, blockC]);

            const questions = [
                ...blockE,
                ...middleBlocks.flat(),
                ...blockD
            ];
            
            const regenerateQuiz = React.useCallback(() => {
                setMultiplier(getRandomMultiplier());
                setSelectedAnswers({});
            }, []);

            return (
                <div className="max-w-3xl mx-auto p-5 bg-gray-50">
                    <h1 className="text-4xl font-bold text-center mb-8">
                        Test Version: {multiplier}
                    </h1>
                    <div className="space-y-5">
                        {questions.map((q, questionIndex) => (
                            <div key={questionIndex} className="bg-white rounded-lg p-5 shadow">
                                <h3 className="font-semibold mb-3">Question {questionIndex + 1}</h3>
                                <p className="mb-4">{q.question}</p>
                                {q.alternatives ? (
                                    <div className="space-y-2">
                                        {(typeof q.alternatives === 'function' ? q.alternatives() : q.alternatives).map((alt, optionIndex) => (
                                            <label key={optionIndex} className="flex items-start p-3 bg-gray-50 rounded cursor-pointer hover:bg-gray-100">
                                                <input
                                                    type="checkbox"
                                                    className="mt-1 mr-3"
                                                    checked={selectedAnswers[questionIndex] === optionIndex}
                                                    onChange={() => handleOptionSelect(questionIndex, optionIndex)}
                                                />
                                                <span>{alt}</span>
                                            </label>
                                        ))}
                                    </div>
                                ) : q.textInput ? (
                                    <textarea 
                                        className="w-full p-3 bg-gray-50 rounded border border-gray-300"
                                        rows="3"
                                        placeholder="Enter your answer here..."
                                    />
                                ) : (
                                    <div className="p-3 bg-gray-50 rounded">
                                        {q.answer()}
                                    </div>
                                )}
                            </div>
                        ))}
                    </div>
                    <button
                        onClick={regenerateQuiz}
                        className="mt-5 px-5 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"
                    >
                        Generate New Numbers
                    </button>
                </div>
            );
        };

        ReactDOM.render(<Quiz />, document.getElementById('root'));
    </script>
</body>
</html>
